{% from "moj/components/alert/macro.njk" import mojAlert %}

<em-map
  {% if params.usesInternalOverlays %}uses-internal-overlays{% endif %}
  csp-nonce="{{ params.cspNonce }}"
  {% if params.apiKey %}api-key="{{ params.apiKey }}"{% endif %}
  {% if params.renderer %}renderer="{{ params.renderer }}"{% endif %}
  {% if params.controls.scaleControl %}scale-control="{{ params.controls.scaleControl }}"{% endif %}
  {% if params.controls.zoomSlider %}zoom-slider{% endif %}
  {% if params.controls.rotate is defined %}
    {% if params.controls.rotate.button is defined %}
      {% if params.controls.rotate.button === 'auto-hide' %}
        rotate-control="auto-hide"
      {% elseif params.controls.rotate.button === false %}
        rotate-control="false"
      {% else %}
        {# treat anything truthy / 'always' as "show the button" #}
        rotate-control="true"
      {% endif %}
    {% endif %}

    {% if params.controls.olRotationMode is defined %}
      ol-rotation-mode="{{ params.controls.olRotationMode }}"
    {% endif %}

  {% endif %}
  {% if params.controls.locationDisplay %}location-display="{{ params.controls.locationDisplay }}"{% endif %}
  {% if params.controls.enable3DBuildings %}enable-3d-buildings{% endif %}
  {% if params.controls.grabCursor is not defined or params.controls.grabCursor %}grab-cursor{% endif %}>

  {% if params.alerts and params.alerts.length > 0 %}
    <div slot="alerts" class="em-map__alerts">
      {% for alert in params.alerts %}
        {{ mojAlert(alert) }}
      {% endfor %}
    </div>
  {% endif %}

  {% if params.positions is defined and params.positions %}
    <script type="application/json" slot="position-data">
      {{ params.positions | dump | safe }}
    </script>
  {% endif %}
</em-map>
